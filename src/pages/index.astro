---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";

const allNews = await getCollection("news");

const latestNews = allNews
  .sort((a, b) => {
    return b.data.date.getTime() - a.data.date.getTime();
  })
  .slice(0, 10);
---

<BaseLayout pageTitle="トップページ">
  <div class="container mx-auto px-4 py-8">
    <h1 class="font-semibold text-xl pl-2 border-b-2 border-l-8 border-solid border-black">NEWS</h1>

    <ul>
      {
        latestNews.map(async (item) => {
          const { Content } = await item.render();

          const localeDate = item.data.date.toLocaleDateString("ja-JP", {
            year: "numeric",
            month: "numeric",
            day: "numeric",
          });

          return (
            <li class="border-b py-2 flex flex-col sm:flex-row sm:items-center">
              <p class="mb-2 sm:mb-0 sm:w-30 sm:shrink-0 text-lg tabular-nums">{localeDate}</p>
              <div class="sm:flex-1 prose-a:text-blue-700 prose-a:underline prose-a:hover:text-blue-500">
                <Content />
              </div>
            </li>
          );
        })
      }
    </ul>

    <div class="text-center mt-8">
      <a
        href="/news/1"
        class="inline-block px-6 py-2 bg-gray-700 text-white rounded hover:bg-gray-500 transition-colors"
      >
        もっとみる
      </a>
    </div>
  </div>
</BaseLayout>
